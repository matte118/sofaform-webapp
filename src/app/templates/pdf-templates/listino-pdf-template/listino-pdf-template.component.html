<div class="listino-container" id="listino-pdf-template">
    <!-- Header -->
    <header class="header">
        <img src="logo_sofaform.png" alt="Logo" class="logo" />
        <h1 class="title">Listino Prezzi</h1>
        <h2 class="product-name">{{ product.name }}</h2>
        <p class="description" *ngIf="product.description">
            {{ product.description }}
        </p>
        <span class="date">Data: {{ getCurrentDate() }}</span>
    </header>

    <!-- Technical Sheet -->
    <div class="tech-sheet">
        <h3 class="tech-sheet-caption">SCHEDA TECNICA</h3>

        <div class="tech-row">
            <span class="tech-label">Seduta</span>
            <span class="tech-value">{{ product.seduta || '-' }}</span>
        </div>

        <div class="tech-row">
            <span class="tech-label">Schienale</span>
            <span class="tech-value">{{ product.schienale || '-' }}</span>
        </div>

        <div class="tech-row">
            <span class="tech-label">Meccanica</span>
            <span class="tech-value">{{ product.meccanica || '-' }}</span>
        </div>

        <div class="tech-row">
            <span class="tech-label">Materasso</span>
            <span class="tech-value">{{ product.materasso || '-' }}</span>
        </div>
    </div>

    <!-- Product Photos
    <div class="photo-row" *ngIf="product.photoUrl">
        <img [src]="product.photoUrl" class="sofa-photo" />
    </div> -->

    <!-- Variants and Pricing -->
    <div class="variants-section" *ngFor="let variant of variants; let variantIndex = index">
        <!-- Page break before each variant (except first) -->
        <div [class.page-break]="variantIndex > 0"></div>

        <div class="variant-header">
            <h3>Variante: {{ variant.longName }}</h3>
            <div class="variant-meta" *ngIf="variant.seatsCount || variant.mattressWidth">
                <span *ngIf="variant.seatsCount">{{ variant.seatsCount }} posti</span>
                <span *ngIf="variant.mattressWidth"> - Larghezza: {{ variant.mattressWidth }} cm</span>
            </div>
        </div>

        <!-- Components -->
        <div class="components-table">
            <h4>Componenti</h4>

            <div class="price-table">
                <!-- Header Row -->
                <div class="price-row price-header">
                    <span class="component-name">Componente</span>
                    <span class="quantity">Qtà</span>
                    <span class="unit-price">Prezzo Unitario</span>
                    <span class="total-price">Totale</span>
                </div>

                <!-- Variant Components -->
                <div class="price-row" *ngFor="let component of variant.components">
                    <span class="component-name">{{ component.name }}</span>
                    <span class="quantity">1</span>
                    <span class="unit-price">€ {{ formatPrice(component.price) }}</span>
                    <span class="total-price">€ {{ formatPrice(component.price) }}</span>
                </div>

                <!-- Rivestimenti -->
                <div class="price-row rivestimento-row" *ngFor="let r of rivestimenti">
                    <span class="component-name">Rivestimento: {{ r.rivestimento.name }}</span>
                    <span class="quantity">{{ r.metri }} mt</span>
                    <span class="unit-price">€ {{ formatPrice(r.rivestimento.mtPrice) }}/mt</span>
                    <span class="total-price">€ {{ formatPrice(r.rivestimento.mtPrice * r.metri) }}</span>
                </div>

                <!-- Delivery Cost -->
                <div class="price-row delivery-row" *ngIf="deliveryPrice > 0">
                    <span class="component-name">Costo Consegna</span>
                    <span class="quantity">1</span>
                    <span class="unit-price">€ {{ formatPrice(deliveryPrice) }}</span>
                    <span class="total-price">€ {{ formatPrice(deliveryPrice) }}</span>
                </div>
            </div>
        </div>

        <!-- Pricing Summary -->
        <div class="pricing-summary">
            <div class="summary-row">
                <span class="label">Subtotale:</span>
                <span class="value">€ {{ formatPrice(getVariantBaseTotal(variant)) }}</span>
            </div>
            <div class="summary-row markup-row">
                <span class="label">Ricarico ({{ markupPercentage }}%):</span>
                <span class="value">€ {{ formatPrice(getVariantTotalWithMarkup(variant) - getVariantBaseTotal(variant))
                    }}</span>
            </div>
            <div class="summary-row total-row">
                <span class="label">Totale Finale:</span>
                <span class="value">€ {{ formatPrice(getVariantTotalWithMarkup(variant)) }}</span>
            </div>
        </div>
    </div>

    <!-- Extra Mattresses Grid -->
    <div class="extra-mattress-grid" *ngIf="extraMattresses?.length">
        <p-card *ngFor="let m of extraMattresses" class="mattress-card">
            <ng-template pTemplate="header">{{ m.name }}</ng-template>
            <p>Prezzo extra: € {{ formatPrice(m.price || 0) }}</p>
        </p-card>
    </div>

    <!-- Delivery Cost Box -->
    <div class="delivery-box" *ngIf="deliveryPrice > 0">
        <strong>Costo consegna:</strong>
        € {{ formatPrice(deliveryPrice) }}
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-info">
            <p>Listino generato automaticamente - {{ getCurrentDate() }}</p>
            <p>I prezzi sono da considerarsi IVA esclusa</p>
        </div>
    </div>
</div>